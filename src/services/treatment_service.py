"""
Treatment recommendation service for rice diseases
"""
import streamlit as st
from typing import Dict, Any

class TreatmentService:
    """Service class for providing treatment recommendations"""
    
    def __init__(self):
        self.treatments = self._load_treatments()
    
    def _load_treatments(self) -> Dict[str, Dict[str, Any]]:
        """Load treatment recommendations for different diseases"""
        return {
            'Neck_Blast': {
                'title': 'ЁЯМ╛ Neck Blast (ржЧрзЛржбрж╝рж╛рж░ ржжрж╛ржЧ рж░рзЛржЧ)',
                'cause': 'ржПржЯрж┐ *Magnaporthe oryzae* ржЫрждрзНрж░рж╛ржХ ржжрзНржмрж╛рж░рж╛ рж╕рзГрж╖рзНржЯрж┐ рж╣ржпрж╝ред ржлрзБрж▓ ржЖрж╕рж╛рж░ рж╕ржоржпрж╝ ржЫрждрзНрж░рж╛ржХ ржЧрзЛржБржбрж╝рж╛ ржЖржХрзНрж░ржоржг ржХрж░рзЗ ржзрж╛ржи ржЭрж░рзЗ ржпрж╛ржпрж╝ред',
                'symptoms': [
                    'ржЧрж╛ржЫрзЗрж░ ржХрж╛ржгрзНржбрзЗрж░ ржарж┐ржХ ржирж┐ржЪрзЗ ржмрж╛ржжрж╛ржорзА ржмрж╛ ржзрзВрж╕рж░ рж░ржЩрзЗрж░ ржжрж╛ржЧ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред',
                    'ржЖржХрзНрж░рж╛ржирзНржд ржХржирзНржарзА рж╢рзБржХрж┐ржпрж╝рзЗ ржпрж╛ржпрж╝ ржУ ржжрж╛ржирж╛ рждрзИрж░рж┐ рж╣ржпрж╝ ржирж╛ред',
                    'рж░рзЛржЧ ржмрзЗрж╢рж┐ рж╣рж▓рзЗ ржлрж▓ржирзЗрж░ ржХрзНрж╖рждрж┐ рзорзж% ржкрж░рзНржпржирзНржд рж╣рждрзЗ ржкрж╛рж░рзЗред'
                ],
                'biological_control': [
                    'рж░рзЛржЧржорзБржХрзНржд ржмрзАржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред',
                    'ржзрж╛ржи рж░рзЛржкржгрзЗрж░ ржкрзВрж░рзНржмрзЗ ржмрзАржЬ ржЧрж░ржо ржкрж╛ржирж┐рждрзЗ рж╢рзЛржзржи ржХрж░рзБржиред',
                    'ржЬржорж┐рждрзЗ ржкрж░рзНржпрж╛ржкрзНржд ржкрж╛ржирж┐ ржирж┐рж╖рзНржХрж╛рж╢ржирзЗрж░ ржмрзНржпржмрж╕рзНржерж╛ рж░рж╛ржЦрзБржиред'
                ],
                'chemical_control': [
                    'ржЯрзНрж░рж╛ржЗрж╕рж╛ржЗржХрзНрж▓рж╛ржЬрж▓ (Tricyclazole) ржмрж╛ ржЖржЬрзЛржХрзНрж╕рж┐рж╕рзНржЯрзНрж░рзЛржмрж┐ржи (Azoxystrobin) рж╕рзНржкрзНрж░рзЗ ржХрж░рзБржиред',
                    'ржлрзБрж▓ ржЖрж╕рж╛рж░ рж╕ржоржпрж╝ ржУ рзн ржжрж┐ржи ржкрж░ ржжрзНржмрж┐рждрзАржпрж╝ рж╕рзНржкрзНрж░рзЗ ржХрж░рзБржиред'
                ]
            },
            'Leaf scald': {
                'title': 'ЁЯМ╛ Leaf Scald (ржкрж╛рждрж╛ ржкрзБржбрж╝рзЗ ржпрж╛ржУржпрж╝рж╛ рж░рзЛржЧ)',
                'cause': '*Microdochium oryzae* ржирж╛ржоржХ ржЫрждрзНрж░рж╛ржХрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЫржбрж╝рж╛ржпрж╝ред',
                'symptoms': [
                    'ржкрж╛рждрж╛рж░ ржХрж┐ржирж╛рж░рж╛ржпрж╝ рж╣рж╛рж▓ржХрж╛ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ ржпрж╛ ржкрж░рзЗ ржЧрж╛ржврж╝ ржмрж╛ржжрж╛ржорзА рж╣ржпрж╝ред',
                    'ржкрж╛рждрж╛рж░ ржЙржкрж░рж┐ржнрж╛ржЧрзЗ ржЖржЧрзБржирзЗ ржкрзЛржбрж╝рж╛рж░ ржорждрзЛ ржжрж╛ржЧ ржкржбрж╝рзЗред'
                ],
                'biological_control': [
                    'рж░рзЛржЧржорзБржХрзНржд ржЪрж╛рж░рж╛ рж░рзЛржкржг ржХрж░рзБржиред',
                    'ржЬржорж┐рждрзЗ ржЕрждрж┐рж░рж┐ржХрзНржд ржирж╛ржЗржЯрзНрж░рзЛржЬрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржПржбрж╝рж┐ржпрж╝рзЗ ржЪрж▓рзБржиред',
                    'ржкрж░рзНржпрж╛ржкрзНржд рж░рзЛржж ржУ ржмрж╛рждрж╛рж╕ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржиред'
                ],
                'chemical_control': [
                    'ржкрзНрж░ржпрж╝рзЛржЬржирзЗ ржЯрзНрж░рж╛ржЗрж╕рж╛ржЗржХрзНрж▓рж╛ржЬрж▓ ржЬрж╛рждрзАржпрж╝ ржЫрждрзНрж░рж╛ржХржирж╛рж╢ржХ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рзБржиред'
                ]
            },
            'Sheath Blight': {
                'title': 'ЁЯМ╛ Sheath Blight (ржкрж╛рждрж╛рж░ ржЧрзЛржбрж╝рж╛ ржкржЪрж╛ рж░рзЛржЧ)',
                'cause': '*Rhizoctonia solani* ржЫрждрзНрж░рж╛ржХрзЗрж░ ржЖржХрзНрж░ржоржгрзЗ рж╣ржпрж╝ред',
                'symptoms': [
                    'ржкрж╛рждрж╛рж░ ржЧрзЛржбрж╝рж╛ржпрж╝ ржмрж╛ржжрж╛ржорзА ржмрж╛ ржЫрж╛ржЗ рж░ржЩрзЗрж░ ржжрж╛ржЧ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред',
                    'ржжрж╛ржЧржЧрзБрж▓рзЛ ржзрзАрж░рзЗ ржзрзАрж░рзЗ ржмржбрж╝ рж╣ржпрж╝рзЗ ржкрзБрж░рзЛ ржкрж╛рждрж╛ржХрзЗ ржорзЗрж░рзЗ ржлрзЗрж▓рзЗред'
                ],
                'biological_control': [
                    'рж╕рж╛рж░рж┐рж░ ржмрзНржпржмржзрж╛ржи рж░рзЗржЦрзЗ рж░рзЛржкржг ржХрж░рзБржиред',
                    'рж░рзЛржЧржорзБржХрзНржд ржЬржорж┐рждрзЗ ржЪрж╛рж╖ ржХрж░рзБржиред'
                ],
                'chemical_control': [
                    'рж╣рзЗржХрзНрж╕рж╛ржХрзЛржирж╛ржЬрж▓ ржмрж╛ ржнрзНржпрж╛рж▓рж┐ржбрж╛ржорж╛ржЗрж╕рж┐ржи ржЬрж╛рждрзАржпрж╝ ржЫрждрзНрж░рж╛ржХржирж╛рж╢ржХ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред',
                    'рж╕рзНржкрзНрж░рзЗ рзи ржмрж╛рж░ ржХрж░рзБржи тАУ рж╢рзБрж░рзБрж░ рж▓ржХрзНрж╖ржг ржжрзЗржЦрж╛ ржЧрзЗрж▓рзЗ ржПржмржВ рзн ржжрж┐ржи ржкрж░рзЗред'
                ]
            },
            'Healthy Rice Leaf': {
                'title': 'ЁЯМ╛ Healthy Rice Leaf (рж╕рзБрж╕рзНрже ржзрж╛ржирзЗрж░ ржкрж╛рждрж╛)',
                'cause': 'рж╕рзБрж╕рзНрже ржЕржмрж╕рзНржерж╛',
                'symptoms': [
                    'ржкрж╛рждрж╛ржпрж╝ ржХрзЛржирзЛ ржжрж╛ржЧ ржмрж╛ ржмрж┐ржмрж░рзНржгрждрж╛ ржирзЗржЗред',
                    'ржкрж╛рждрж╛рж░ рж░ржВ ржЧрж╛ржврж╝ рж╕ржмрзБржЬ ржУ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзАред'
                ],
                'biological_control': [
                    'ржП ржЕржмрж╕рзНржерж╛ржпрж╝ ржХрзЛржирзЛ ржирж┐ржпрж╝ржирзНрждрзНрж░ржгрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗ, ржмрж░ржВ рж╕рзБрж╕рзНрже ржЕржмрж╕рзНржерж╛ржХрзЗ ржмржЬрж╛ржпрж╝ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп ржирж┐ржпрж╝ржорж┐ржд ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржЬрж░рзБрж░рж┐ред'
                ],
                'chemical_control': []
            },
            'Narrow Brown Leaf Spot': {
                'title': 'ЁЯМ╛ Narrow Brown Leaf Spot (ржкрж╛рждрж╛ржпрж╝ рж╕рж░рзБ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ)',
                'cause': '*Septoria oryzae* ржЫрждрзНрж░рж╛ржХржЬржирж┐ржд рж░рзЛржЧред',
                'symptoms': [
                    'ржкрж╛рждрж╛ржпрж╝ рж╕рж░рзБ рж▓ржорзНржмрж╛ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред',
                    'ржжрж╛ржЧржЧрзБрж▓рзЛ ржПржХрждрзНрж░рзЗ рж╣ржпрж╝рзЗ ржкрж╛рждрж╛ рж╢рзБржХрж┐ржпрж╝рзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░рзЗред'
                ],
                'biological_control': [
                    'рж░рзЛржЧржорзБржХрзНржд ржмрзАржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред',
                    'рж╕рзБрж╖ржо рж╕рж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред'
                ],
                'chemical_control': [
                    'ржкрзНрж░ржпрж╝рзЛржЬржирзЗ ржХржкрж╛рж░ ржнрж┐рждрзНрждрж┐ржХ ржЫрждрзНрж░рж╛ржХржирж╛рж╢ржХ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред'
                ]
            },
            'Leaf Blast': {
                'title': 'ЁЯМ╛ Leaf Blast (ржкрж╛рждрж╛ржпрж╝ ржжрж╛ржЧ рж░рзЛржЧ)',
                'cause': '*Magnaporthe oryzae* ржЫрждрзНрж░рж╛ржХрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЫржбрж╝рж╛ржпрж╝ред',
                'symptoms': [
                    'ржкрж╛рждрж╛ржпрж╝ ржбрж╛ржпрж╝ржоржирзНржб ржЖржХрзГрждрж┐рж░ ржЫрж╛ржЗ ржмрж╛ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред',
                    'ржжрж╛ржЧ ржмржбрж╝ рж╣ржпрж╝рзЗ ржкрж╛рждрж╛ржХрзЗ ржорзЗрж░рзЗ ржлрзЗрж▓рзЗред'
                ],
                'biological_control': [
                    'рж░рзЛржЧржорзБржХрзНржд ржмрзАржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред',
                    'ржзрж╛ржи ржШржиржнрж╛ржмрзЗ рж░рзЛржкржг ржПржбрж╝рж┐ржпрж╝рзЗ ржЪрж▓рзБржиред'
                ],
                'chemical_control': [
                    'ржЯрзНрж░рж╛ржЗрж╕рж╛ржЗржХрзНрж▓рж╛ржЬрж▓ рж╕рзНржкрзНрж░рзЗ ржХрж░рзБржиред'
                ]
            },
            'Rice Hispa': {
                'title': 'ЁЯМ╛ Rice Hispa (рж░рж╛ржЗрж╕ рж╣рж┐ржЫржкрж╛ ржХрзАржЯ ржЖржХрзНрж░ржоржг)',
                'cause': '*Dicladispa armigera* ржирж╛ржоржХ ржкрзЛржХрж╛ ржжрзНржмрж╛рж░рж╛ ржЖржХрзНрж░рж╛ржирзНржд рж╣ржпрж╝ред',
                'symptoms': [
                    'ржкрж╛рждрж╛рж░ ржЙржкрж░рж┐ржнрж╛ржЧрзЗ ржЖржБржХрж╛ржмрж╛ржБржХрж╛ рж╕рж╛ржжрж╛ ржжрж╛ржЧ ржкржбрж╝рзЗред',
                    'ржкрзЛржХрж╛ ржкрж╛рждрж╛рж░ рж╕ржмрзБржЬ ржЕржВрж╢ ржЦрзЗржпрж╝рзЗ ржлрзЗрж▓рзЗред'
                ],
                'biological_control': [
                    'ржЖржХрзНрж░рж╛ржирзНржд ржкрж╛рждрж╛ рждрзБрж▓рзЗ ржлрзЗрж▓рзБржиред',
                    'рж╢рж┐ржХрж╛рж░рж┐ ржкрзЛржХрж╛ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржиред'
                ],
                'chemical_control': [
                    'ржЗржорж┐ржбрж╛ржХрзНрж▓рзЛржкрж░рж┐ржб ржмрж╛ ржХрзБржЗржирж╛рж▓ржлрж╕ рж╕рзНржкрзНрж░рзЗ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред'
                ]
            },
            'Brown Spot': {
                'title': 'ЁЯМ╛ Brown Spot (ржкрж╛рждрж╛ржпрж╝ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ рж░рзЛржЧ)',
                'cause': '*Bipolaris oryzae* ржЫрждрзНрж░рж╛ржХ ржжрзНржмрж╛рж░рж╛ рж╕рзГрж╖рзНржЯред',
                'symptoms': [
                    'ржкрж╛рждрж╛ржпрж╝ ржЧрзЛрж▓ ржмрж╛ржжрж╛ржорзА ржжрж╛ржЧ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред',
                    'ржжрж╛ржЧрзЗрж░ ржХрзЗржирзНржжрзНрж░рзЗ рж╕рж╛ржжрж╛ ржПржмржВ ржЪрж╛рж░ржкрж╛рж╢рзЗ ржЧрж╛ржврж╝ ржмрж╛ржжрж╛ржорзАред'
                ],
                'biological_control': [
                    'ржнрж╛рж▓рзЛ ржирж┐рж╖рзНржХрж╛рж╢ржи ржмрзНржпржмрж╕рзНржерж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржиред',
                    'рж╕рзБрж╖ржо рж╕рж╛рж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред'
                ],
                'chemical_control': [
                    'ржорзНржпрж╛ржиржХрзЛржЬрзЗржм ржЬрж╛рждрзАржпрж╝ ржЫрждрзНрж░рж╛ржХржирж╛рж╢ржХ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рзБржиред'
                ]
            },
            'Bacterial Leaf Blight': {
                'title': 'ЁЯМ╛ Bacterial Leaf Blight (ржкрж╛рждрж╛ ржкржБржЪрж╛ ржмрзНржпрж╛ржХржЯрзЗрж░рж┐ржпрж╝рж╛ рж░рзЛржЧ)',
                'cause': '*Xanthomonas oryzae pv. oryzae* ржмрзНржпрж╛ржХржЯрзЗрж░рж┐ржпрж╝рж╛ ржжрзНржмрж╛рж░рж╛ рж╣ржпрж╝ред',
                'symptoms': [
                    'ржкрж╛рждрж╛рж░ ржХрж┐ржирж╛рж░рж╛ ржерзЗржХрзЗ ржжрж╛ржЧ рж╢рзБрж░рзБ рж╣ржпрж╝рзЗ ржкрзБрж░рзЛ ржкрж╛рждрж╛ рж╢рзБржХрж┐ржпрж╝рзЗ ржлрзЗрж▓рзЗред',
                    'рж╕ржХрж╛рж▓рзЗ ржкрж╛рждрж╛ржпрж╝ рж╣рж╛рж▓ржХрж╛ рж╕рж╛ржжрж╛ ржЖржарж╛рж▓рзЛ рждрж░рж▓ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ред'
                ],
                'biological_control': [
                    'рж░рзЛржЧржорзБржХрзНржд ржмрзАржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред',
                    'ржЬржорж┐рждрзЗ ржкрж╛ржирж┐ ржЬржорждрзЗ ржжрзЗржмрзЗржи ржирж╛ред'
                ],
                'chemical_control': [
                    'ржХржкрж╛рж░ ржЕржХрзНрж╕рж┐ржХрзНрж▓рзЛрж░рж╛ржЗржб ржмрж╛ рж╕рзНржЯрзНрж░рзЗржкрзНржЯрзЛрж╕рж╛ржЗржХрзНрж▓рж┐ржи ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред'
                ]
            }
        }
    
    def get_treatment(self, disease_name: str) -> str:
        """Get treatment recommendation for a specific disease"""
        if disease_name not in self.treatments:
            return "Unknown disease. Please consult with an agricultural expert."
        
        treatment = self.treatments[disease_name]
        
        # Format the treatment information
        markdown = f"""
        ### {treatment['title']}

        **ЁЯжа ржХрж╛рж░ржг:**  
        {treatment['cause']}

        **ЁЯФН рж▓ржХрзНрж╖ржг:**  
        """
        
        for symptom in treatment['symptoms']:
            markdown += f"- {symptom}  \n"
        
        if treatment['biological_control']:
            markdown += "\n#### ЁЯМ▒ ржЬрзИржмрж┐ржХ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг:  \n"
            for control in treatment['biological_control']:
                markdown += f"- {control}  \n"
        
        if treatment['chemical_control']:
            markdown += "\n#### ЁЯТК рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг:  \n"
            for control in treatment['chemical_control']:
                markdown += f"- {control}  \n"
        
        return markdown
    
    def display_treatment(self, disease_name: str):
        """Display treatment recommendation in Streamlit"""
        treatment_markdown = self.get_treatment(disease_name)
        st.markdown(treatment_markdown)
